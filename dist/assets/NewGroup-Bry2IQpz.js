import{d as C,j as e,e as P,n as g,r as D,bv as _,_ as k,L as E,S as a,h as F,T as b,N as H,bw as T,bx as U,i as f}from"./index-DXIXWoHh.js";import{P as W}from"./Person-zo9cBc74.js";import{z as L}from"./index-kjwOohNt.js";import{U as z}from"./UserItem-DrW4Ry-J.js";import{D as R,a as V}from"./DialogTitle-BS4nDxqb.js";import{T as B}from"./TextField-poyfljeC.js";import{I as Q}from"./InputAdornment-CJnrlikC.js";import{C as j}from"./Chip-Ddt6Sn-T.js";import{B as v}from"./Button-tIdt4f3V.js";import"./ListItem-B6K27DpV.js";import"./isMuiElement-r8vo_iCU.js";const $=C(e.jsx("path",{d:"M12 2C6.47 2 2 6.47 2 12s4.47 10 10 10 10-4.47 10-10S17.53 2 12 2m5 13.59L15.59 17 12 13.41 8.41 17 7 15.59 10.59 12 7 8.41 8.41 7 12 10.59 15.59 7 17 8.41 13.41 12z"}),"Cancel"),q=C(e.jsx("path",{d:"M22 9V7h-2v2h-2v2h2v2h2v-2h2V9zM8 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m0 1c-2.67 0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4m4.51-8.95C13.43 5.11 14 6.49 14 8s-.57 2.89-1.49 3.95C14.47 11.7 16 10.04 16 8s-1.53-3.7-3.49-3.95m4.02 9.78C17.42 14.66 18 15.7 18 17v3h2v-3c0-1.45-1.59-2.51-3.47-3.17"}),"GroupAdd"),te=()=>{var x;const I=P(),{isNewGroup:w}=g(r=>r.misc),{user:i}=g(r=>r.auth),m=i==null?void 0:i._id,t=L(""),[o,u]=D.useState([]),p=null,{isError:S,isLoading:A,error:G,data:s}=_(p),[y,M]=k(U);console.log("Using chatId for friends fetch:",p),E([{isError:S,error:G}]);const h=r=>{u(n=>n.includes(r)?n.filter(d=>d!==r):[...n,r])},N=()=>{if(!t.value)return f.error("Please enter group name");if(o.length<1)return f.error("Please select at least one member");y("Creating new group...",{namee:t.value,members:o}),l()},l=()=>{I(T(!1)),u([])},c=((x=s==null?void 0:s.friends)==null?void 0:x.filter(r=>String(r._id)!==String(m)))||[];return console.log("Current User ID:",m),console.log("Friend IDs:",s==null?void 0:s.friends.map(r=>r._id)),console.log("Friends from API:",s==null?void 0:s.friends),e.jsx(R,{onClose:l,open:w,PaperProps:{sx:{background:"rgba(236, 227, 227, 0.97)",backdropFilter:"blur(10px)",boxShadow:"0 4px 30px rgba(0, 0, 0, 0.1)",borderRadius:"15px",padding:"2rem",border:"1px solid rgba(235, 231, 231, 0.97)"}},children:e.jsxs(a,{children:[e.jsx(V,{textAlign:"center",children:"Create New Group"}),e.jsx(B,{label:"Group Name",placeholder:"Enter group name",value:t.value,onChange:t.changeHandler,variant:"outlined",fullWidth:!0,sx:{mb:2},InputProps:{startAdornment:e.jsx(Q,{position:"start",children:e.jsx(W,{})})}}),o.length>0&&e.jsxs(a,{direction:"row",spacing:1,mb:2,flexWrap:"wrap",alignItems:"center",children:[o.slice(0,3).map(r=>{const n=c.find(d=>d._id===r);return n?e.jsx(j,{label:n.namee,avatar:e.jsx(F,{src:n.avatar}),onDelete:()=>h(r)},r):null}),o.length>3&&e.jsx(j,{label:`+${o.length-3} more`,color:"primary",variant:"outlined"})]}),e.jsx(b,{variant:"body1",fontWeight:"bold",mb:1,children:"Select Members"}),e.jsx(a,{maxHeight:"12rem",overflow:"auto",spacing:1,sx:{border:"1px solid #ddd",p:1,borderRadius:2},children:A?e.jsx(H,{}):c.length>0?c.map(r=>e.jsx(z,{user:r,handler:h,isAdded:o.includes(r._id)},r._id)):e.jsx(b,{textAlign:"center",color:"text.secondary",children:"No friends available"})}),e.jsxs(a,{direction:"row",spacing:2,justifyContent:"center",mt:3,children:[e.jsx(v,{variant:"contained",color:"primary",fullWidth:!0,startIcon:e.jsx(q,{}),onClick:N,disabled:M,children:"Create"}),e.jsx(v,{variant:"outlined",color:"error",fullWidth:!0,startIcon:e.jsx($,{}),onClick:l,children:"Cancel"})]})]})})};export{te as default};
