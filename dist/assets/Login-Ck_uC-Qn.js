import{u as M,a as U,r as j,R,b as z,c as V,d as P,j as e,e as $,f as N,T as g,S as W,B as I,h as O,I as _,V as G,i as b,k as H,s as D,l as T,m as A}from"./index-DXIXWoHh.js";import{b as J,z as C,R as K,L as X}from"./index-kjwOohNt.js";import{i as Y,a as Z}from"./image2-DS5xwtyH.js";import{C as q}from"./Container-WUJ_qu9L.js";import{T as x}from"./TextField-poyfljeC.js";import{B as F}from"./Button-tIdt4f3V.js";import"./isMuiElement-r8vo_iCU.js";function ee(n,d,t,o,u){const[a,r]=j.useState(()=>u&&t?t(n).matches:o?o(n).matches:d);return z(()=>{if(!t)return;const s=t(n),c=()=>{r(s.matches)};return c(),s.addEventListener("change",c),()=>{s.removeEventListener("change",c)}},[n,t]),a}const te={...R},Q=te.useSyncExternalStore;function ne(n,d,t,o,u){const a=j.useCallback(()=>d,[d]),r=j.useMemo(()=>{if(u&&t)return()=>t(n).matches;if(o!==null){const{matches:i}=o(n);return()=>i}return a},[a,n,o,u,t]),[s,c]=j.useMemo(()=>{if(t===null)return[a,()=>()=>{}];const i=t(n);return[()=>i.matches,l=>(i.addEventListener("change",l),()=>{i.removeEventListener("change",l)})]},[a,t,n]);return Q(c,s,r)}function B(n={}){const{themeId:d}=n;return function(o,u={}){let a=M();a&&d&&(a=a[d]||a);const r=typeof window<"u"&&typeof window.matchMedia<"u",{defaultMatches:s=!1,matchMedia:c=r?window.matchMedia:null,ssrMatchMedia:f=null,noSsr:i=!1}=U({name:"MuiUseMediaQuery",props:u,theme:a});let l=typeof o=="function"?o(a):o;return l=l.replace(/^@media( ?)/m,""),(Q!==void 0?ne:ee)(l,s,c,f,i)}}B();const ae=B({themeId:V}),re=P([e.jsx("circle",{cx:"12",cy:"12",r:"3.2"},"0"),e.jsx("path",{d:"M9 2 7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5"},"1")],"CameraAlt"),se=n=>{if(!J(n))return{isValid:!1,errorMessage:"username is invalid"}},he=()=>{const[n,d]=j.useState(!0),[t,o]=j.useState(!1),u=()=>d(!n),a=C(""),r=C("",se),s=K(),c=C(""),f=C(""),i=X(),l=$(),E=async L=>{var S,y;L.preventDefault();const w=b.loading("Logging in...");o(!0);const p={withCredentials:!0,headers:{"Content-Type":"application/json"}};try{const{data:m}=await H.post(`${D}/api/v1/user/login`,{username:r.value,password:s.value},p);l(T.util.resetApiState()),l(A(m.user)),b.success(m.message,{id:w})}catch(m){b.error(((y=(S=m==null?void 0:m.response)==null?void 0:S.data)==null?void 0:y.message)||"Something went wrong",{id:w})}finally{o(!1)}},k=async L=>{var y,m;L.preventDefault(),o(!0);const w=b.loading("Signing up..."),p=new FormData;p.append("avatar",i.file),p.append("namee",a.value),p.append("bio",f.value),p.append("username",r.value),p.append("password",s.value);const S={withCredentials:!0,headers:{"Content-Type":"multipart/form-data"}};try{const{data:v}=await H.post(`${D}/api/v1/user/new`,p,S);l(T.util.resetApiState()),l(A(v.user)),b.success(v.message,{id:w})}catch(v){b.error(((m=(y=v==null?void 0:v.response)==null?void 0:y.data)==null?void 0:m.message)||"Something went wrong",{id:w})}finally{o(!1)}};N();const h=ae("(max-width:1500px)");return e.jsxs(e.Fragment,{children:[e.jsx(q,{component:"main",maxWidth:"xs",sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:h?"100%":"600px",width:h?"100%":"400px",position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",background:h?"linear-gradient(to right, #FFDEE9, #B5FFFC)":"rgba(255, 255, 255, 0.2)",backdropFilter:h?"none":"blur(5px)",borderRadius:h?"0%":"10px",border:h?"none":"1px solid rgba(255, 255, 255, 0.3)",boxShadow:h?"0 4px 10px rgba(0,0,0,0.15)":"0 4px 6px rgba(0, 0, 0, 0.1)",padding:"2rem",zIndex:2},children:n?e.jsxs(e.Fragment,{children:[e.jsx(g,{variant:"h4",textAlign:"center",children:"Login"}),e.jsxs("form",{onSubmit:E,children:[e.jsx(x,{required:!0,fullWidth:!0,label:"Username",margin:"normal",value:r.value,onChange:r.changeHandler}),r.error&&e.jsx(g,{color:"error",variant:"caption",children:r.error}),e.jsx(x,{required:!0,fullWidth:!0,label:"Password",type:"password",margin:"normal",value:s.value,onChange:s.changeHandler}),s.error&&e.jsx(g,{color:"error",variant:"caption",children:s.error}),e.jsx(F,{variant:"contained",type:"submit",fullWidth:!0,sx:{mt:2,mb:1,backgroundColor:"#FF5733","&:hover":{backgroundColor:"#FF5733"}},disabled:t,children:"Login"}),e.jsx(g,{textAlign:"center",children:"Or"}),e.jsx(F,{fullWidth:!0,variant:"text",onClick:u,disabled:t,children:"Sign Up"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(W,{direction:"row",alignItems:"center",justifyContent:"center",spacing:2,children:[e.jsx(g,{variant:"h5",children:"Sign Up"}),e.jsxs(I,{sx:{position:"relative"},children:[e.jsx(O,{src:i.preview,sx:{width:64,height:64}}),e.jsxs(_,{component:"label",sx:{position:"absolute",bottom:0,right:0,width:26,height:26,bgcolor:"rgba(0,0,0,0.5)",color:"white",":hover":{bgcolor:"rgba(0,0,0,0.7)"}},children:[e.jsx(re,{fontSize:"small"}),e.jsx(G,{type:"file",onChange:i.changeHandler})]})]})]}),i.error&&e.jsx(g,{color:"error",variant:"caption",mt:1,children:i.error}),e.jsxs("form",{onSubmit:k,children:[e.jsx(x,{fullWidth:!0,label:"Full Name",margin:"normal",value:a.value,onChange:a.changeHandler}),e.jsx(x,{fullWidth:!0,label:"Username",margin:"normal",value:r.value,onChange:r.changeHandler}),r.error&&e.jsx(g,{color:"error",variant:"caption",children:r.error}),e.jsx(x,{fullWidth:!0,label:"Bio",margin:"normal",value:f.value,onChange:f.changeHandler}),e.jsxs(W,{direction:"row",spacing:1,children:[e.jsx(x,{fullWidth:!0,label:"Password",type:"password",margin:"normal",value:s.value,onChange:s.changeHandler}),e.jsx(x,{fullWidth:!0,label:"Confirm Password",type:"password",margin:"normal",value:c.value,onChange:c.changeHandler})]}),e.jsx(F,{fullWidth:!0,type:"submit",variant:"contained",sx:{mt:2,backgroundColor:"#FF5733","&:hover":{backgroundColor:"#FF5733"}},disabled:t,children:"Sign Up"}),e.jsx(g,{textAlign:"center",mt:1,children:"Already have an account?"}),e.jsx(F,{fullWidth:!0,variant:"text",onClick:u,disabled:t,children:"Login"})]})]})}),!h&&e.jsxs(e.Fragment,{children:[e.jsx(I,{component:"img",src:Y,alt:"Emoji Background",sx:{position:"absolute",top:"23%",left:"10%",transform:"translate(-50%, -50%)",width:"73%",zIndex:1}}),e.jsx(I,{component:"img",src:Z,alt:"Decoration",sx:{position:"absolute",top:"75%",left:"82%",transform:"translate(-50%, -50%)",width:"28%",zIndex:1}})]})]})};export{he as default};
